<ion-header>
  <ion-toolbar>
    <ion-title>Browse</ion-title>
  </ion-toolbar>
  <ion-toolbar>
    <ion-searchbar placeholder="Search for music" (ionInput)="onSearch($event)">
    </ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding-bottom">
  <div *ngIf="errorMsg" class="error-message">
    <ion-icon name="alert-circle" color="danger"></ion-icon>
    {{ errorMsg }}
  </div>
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <ion-list>
    <ion-item *ngFor="let track of tracks">
      <ion-thumbnail slot="start">
        <img [src]="track.album_image || 'assets/placeholder.png'" />
      </ion-thumbnail>
      <ion-label (click)="playTrack(track)" style="flex:1; cursor:pointer;">
        <h2>{{ track.name }}</h2>
        <p>{{ track.artist_name }}</p>
      </ion-label>
      <ion-button fill="clear" color="success" (click)="addToPlaylist(track, $event)">
        <ion-icon slot="icon-only" [name]="likedTrackIds.has(track.id) ? 'heart' : 'heart-outline'"
          [color]="likedTrackIds.has(track.id) ? 'danger' : ''">
        </ion-icon>
      </ion-button>
      <ion-button fill="clear" color="primary" slot="end"
        (click)="downloadTrack(track, $event); $event.stopPropagation()" [disabled]="downloadedTrackIds.has(track.id)">
        <ion-icon slot="icon-only" name="download-outline"></ion-icon>
      </ion-button>
    </ion-item>
  </ion-list>
  <div style="height: 100px;"></div>
</ion-content>